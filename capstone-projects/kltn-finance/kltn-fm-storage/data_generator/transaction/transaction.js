const fs = require("fs");

const categoryIds = {
  income: [
    8322314420813824, 8340964353376256, 8340964377722880, 8340964384768000,
    8340964391321600, 8340964404133888, 8340964426121216, 8340964438933504,
    8340964459184128, 8340964467015680, 8340964473765888, 8340964480548864,
    8340964488216576, 8340964505387008, 8340964513841152, 8340964534255616,
    8340964541562880, 8340964555980800, 8340964574691328, 8340964594057216,
  ],
  expense: [
    8322315042586624, 8340964366680064, 8340964396990464, 8340964411539456,
    8340964418584576, 8340964432674816, 8340964446240768, 8340964452696064,
    8340964496900096, 8340964521148416, 8340964527833088, 8340964548280320,
    8340964630822912, 8340964652711936, 8340964674502656, 8340964684955648,
    8340964721819648, 8340964732796928, 8340964740825088, 8340964753932288,
  ],
};

const employeeIds = [
  8313653263695872, 8320740878581760, 8340623243018240, 8340623268478976,
  8340623292366848, 8340623315599360, 8340623342403584, 8340623382085632,
  8340623409840128, 8340623438053376, 8340623473246208, 8340623495036928,
  8340623523217408, 8340623553691648, 8340623575252992, 8340623595995136,
  8340623616966656, 8340623647571968, 8340623681912832, 8340623704227840,
  8340623736209408, 8340623760031744, 8340623786475520, 8340623821406208,
  8340623848865792, 8340623874719744,
];

const transactionGroupIds = [
  8318807930044416, 8318808316608512, 8318949400608768, 8318951134101504,
  8319064282234880, 8319064794955776, 8328034668347392, 8328035754409984,
  8329332349272064, 8340764280619008, 8340764295462912, 8340764315779072,
  8340764342222848, 8340764349169664, 8340764356050944, 8340764363882496,
  8340764371615744, 8340764378005504, 8340764384264192, 8340764391374848,
  8340764401074176, 8340764407758848, 8340764414312448, 8340764423094272,
  8340764431679488, 8340764438429696, 8340764447014912, 8340764456615936,
  8340764462972928, 8340764469886976, 8340764475686912, 8340764482928640,
  8340764489580544, 8340764496756736, 8340764503506944, 8340764509831168,
  8340764517367808, 8340764524969984, 8340764531687424, 8340764538208256,
  8340764544991232, 8340764551249920, 8340764558917632, 8340764565733376,
  8340764572909568, 8340764579725312, 8340764597059584, 8340764610789376,
  8340764625698816, 8340764645654528, 8340764656828416, 8340764664987648,
  8340764672557056, 8340764681109504, 8340764690710528, 8340764700934144,
  8340764710043648, 8340764717383680, 8340764723642368,
];

const tagIds = [
  8323820791824384, 8323839768526848, 8324832353386496, 8340663224041472,
  8340663267000320, 8340663284203520, 8340663306747904, 8340663339450368,
  8340663353901056, 8340663361404928, 8340663441948672, 8340663652974592,
  8340663689052160, 8340663721656320, 8340663770021888, 8340663981899776,
  8340664026136576, 8340664081154048, 8340664116805632, 8340664131190784,
  8340664202035200, 8340664296800256, 8340664309022720, 8340664328945664,
  8340664343166976, 8340664394350592, 8340664595447808, 8340664613568512,
  8340664649187328, 8340664799395840, 8340664936628224, 8340664970248192,
  8340664987746304, 8340665001082880, 8340665129992192, 8340665340657664,
  8340665448398848, 8340665516785664, 8340665531138048, 8340665568690176,
  8340665725419520, 8340665789546496, 8340665855016960, 8340665867960320,
  8340665882705920, 8340665897877504, 8340665911476224, 8340665970622464,
  8340665978945536,
];

const names = [
  "Chuyển khoản lương tháng 1",
  "Thanh toán hóa đơn điện",
  "Mua hàng online",
  "Rút tiền ATM",
  "Nạp tiền điện thoại",
  "Chuyển khoản nội bộ",
  "Nhận tiền từ khách hàng",
  "Trả góp điện thoại",
  "Mua vé máy bay",
  "Thanh toán hóa đơn nước",
  "Gửi tiết kiệm ngân hàng",
  "Nhận thưởng công ty",
  "Chi phí tiếp khách",
  "Thanh toán thẻ tín dụng",
  "Chuyển tiền đầu tư",
  "Mua bảo hiểm nhân thọ",
  "Đóng phí hội viên phòng gym",
  "Trả lãi vay ngân hàng",
  "Nhận hoa hồng bán hàng",
  "Chi phí du lịch",
  "Thanh toán dịch vụ internet",
  "Nạp tiền ví điện tử",
  "Mua sắm thiết bị điện tử",
  "Thanh toán dịch vụ bảo trì xe",
  "Nhận trợ cấp từ gia đình",
  "Trả phí thuê nhà",
  "Giao dịch cổ phiếu",
  "Nhận hoàn thuế",
  "Đóng bảo hiểm xe máy",
  "Mua sắm đồ gia dụng",
  "Thanh toán phí bảo hiểm sức khỏe",
  "Nhận tiền đặt cọc",
  "Đóng học phí",
  "Trả phí dịch vụ phần mềm",
  "Mua thực phẩm hàng tháng",
  "Chi phí khám chữa bệnh",
  "Đầu tư bất động sản",
  "Thanh toán tiền taxi",
  "Rút tiền mặt tại quầy",
  "Giao dịch chuyển ngoại tệ",
  "Đóng phí bảo trì chung cư",
  "Nhận tiền bảo hiểm",
  "Chi phí quảng cáo online",
  "Mua sách và tài liệu học tập",
  "Đóng phí sử dụng dịch vụ streaming",
  "Gửi tiền mừng đám cưới",
  "Mua vé xem phim",
  "Mua thẻ quà tặng",
  "Đặt cọc thuê xe",
  "Mua sắm quần áo",
  "Chuyển tiền cho bạn bè",
  "Trả lương cho nhân viên",
  "Chi phí bảo trì nhà cửa",
  "Đặt hàng thực phẩm",
  "Mua thực phẩm hữu cơ",
  "Chi phí học thêm",
  "Đóng phí bảo trì xe hơi",
  "Trả góp mua nhà",
  "Gửi tiền cho con cái",
  "Thanh toán dịch vụ điện thoại",
  "Mua sắm giày dép",
  "Chi phí y tế",
  "Đầu tư vào quỹ chứng khoán",
  "Mua sắm đồ thể thao",
  "Thanh toán phí dịch vụ ngân hàng",
  "Chi phí tổ chức sự kiện",
  "Mua vé tham dự hội thảo",
  "Đóng phí thành viên câu lạc bộ",
  "Gửi tiền tiết kiệm",
  "Chi phí đi lại",
  "Nhận tiền thưởng cuối năm",
  "Mua đồ chơi trẻ em",
  "Chi phí chăm sóc sức khỏe",
  "Đặt vé tour du lịch",
  "Mua sắm văn phòng phẩm",
  "Trả tiền thuê văn phòng",
  "Chi phí xây dựng",
  "Mua sắm đồ trang trí",
  "Đặt cọc mua đất",
  "Nhận tiền bảo trì nhà",
  "Chi phí dịch vụ sửa chữa",
  "Gửi tiền về quê",
  "Mua sắm thiết bị văn phòng",
  "Chi phí làm đẹp",
  "Thanh toán chi phí học online",
  "Mua bảo hiểm xe hơi",
  "Trả phí tập gym",
  "Chi phí mua sắm quà tặng",
  "Gửi tiền cho tổ chức từ thiện",
  "Mua sắm thiết bị gia đình",
  "Chi phí dịch vụ sửa chữa điện",
  "Đặt cọc thuê mặt bằng",
  "Đầu tư vào khởi nghiệp",
  "Mua vé tham dự concert",
  "Chi phí mua sách",
  "Thanh toán dịch vụ bảo trì máy móc",
  "Chi phí làm phim",
  "Mua sắm thiết bị công nghệ",
  "Chi phí bảo trì website",
  "Đặt cọc mua xe",
  "Nhận tiền từ hợp đồng",
  "Gửi tiền cho bạn bè",
  "Chi phí chăm sóc thú cưng",
  "Đầu tư vào giáo dục",
  "Mua sắm đồ dùng học tập",
  "Thanh toán phí bảo trì tài sản",
  "Chi phí thuê dịch vụ",
  "Mua vé tham dự sự kiện",
  "Chi phí bảo trì công nghệ",
  "Chuyển tiền quốc tế",
  "Nhận tiền từ bảo hiểm",
  "Mua sắm đồ trang sức",
  "Gửi tiền cho người thân",
  "Chi phí marketing",
  "Thanh toán phí dịch vụ đồ ăn",
  "Mua vé máy bay khứ hồi",
  "Chi phí tổ chức tiệc",
  "Đặt hàng quà tặng",
  "Mua sắm đồ nội thất",
  "Chi phí làm tài liệu",
  "Gửi tiền cho người lớn tuổi",
  "Mua sắm quần áo trẻ em",
  "Chi phí chăm sóc cây cảnh",
  "Trả tiền thuê nhà hàng tháng",
  "Mua sắm đồ dùng gia đình",
  "Chi phí bảo trì đồ dùng",
  "Đặt hàng online",
  "Mua bảo hiểm nhà",
  "Chi phí dịch vụ giao hàng",
  "Gửi tiền cho dự án",
  "Mua vé tham quan",
  "Chi phí du lịch nước ngoài",
  "Đặt hàng dịch vụ chăm sóc sức khỏe",
  "Mua thiết bị điện thoại",
  "Chi phí tổ chức hội nghị",
  "Mua vé xem thể thao",
  "Chi phí xây dựng nhà",
  "Nhận tiền từ việc cho thuê",
  "Gửi tiền cho tổ chức xã hội",
  "Mua đồ ăn nhanh",
  "Chi phí sinh hoạt hàng tháng",
  "Đặt cọc thuê phòng",
  "Mua sắm dụng cụ thể thao",
  "Chi phí sửa chữa nhà",
  "Gửi tiền cho tổ chức văn hóa",
  "Mua vé xem hòa nhạc",
  "Chi phí mua sắm đồ điện lạnh",
  "Nhận tiền từ việc làm thêm",
  "Gửi tiền cho người bạn",
  "Mua thực phẩm chế biến sẵn",
  "Chi phí bảo trì phần mềm",
  "Đặt hàng thực phẩm online",
  "Mua sắm quà cho bạn bè",
  "Chi phí tổ chức sinh nhật",
  "Mua vé xem kịch",
  "Chi phí mua sắm thiết bị làm bếp",
  "Nhận tiền từ đầu tư",
  "Gửi tiền cho quỹ từ thiện",
  "Mua sắm đồ chơi cho trẻ em",
  "Chi phí tham gia khóa học",
  "Mua vé xem chương trình giải trí",
  "Chi phí mua sắm đồ dùng văn phòng",
  "Gửi tiền cho dự án cộng đồng",
  "Mua bảo hiểm sức khỏe",
  "Chi phí tổ chức lễ hội",
  "Mua vé tham dự hội thảo",
  "Chi phí mua sắm đồ dùng cá nhân",
  "Nhận tiền từ thị trường chứng khoán",
  "Gửi tiền cho quỹ đầu tư",
  "Mua sắm đồ dùng cho thú cưng",
  "Chi phí thuê dịch vụ vệ sinh",
  "Đặt cọc mua vé máy bay",
  "Nhận tiền từ hợp đồng lao động",
  "Chi phí mua sắm thiết bị học tập",
  "Mua vé tham dự sự kiện thể thao",
  "Chi phí bảo trì xe đạp",
  "Gửi tiền cho chương trình giáo dục",
  "Mua sắm đồ dùng công nghiệp",
  "Chi phí tổ chức sự kiện thể thao",
  "Mua vé tham dự triển lãm",
  "Chi phí mua bảo hiểm xe",
  "Gửi tiền cho chương trình từ thiện",
  "Mua sắm thiết bị y tế",
  "Chi phí dịch vụ kế toán",
  "Đặt hàng đồ ăn trực tuyến",
  "Mua vé xem phim tại rạp",
  "Chi phí tổ chức hội thảo",
  "Nhận tiền từ việc cho thuê tài sản",
  "Gửi tiền cho tổ chức phi lợi nhuận",
  "Mua sắm đồ dùng cho gia đình",
  "Chi phí bảo trì hệ thống điện",
  "Mua vé tham gia khóa học",
  "Nhận tiền thưởng từ công việc",
  "Gửi tiền cho bạn bè và gia đình",
  "Mua sắm đồ dùng vệ sinh",
  "Chi phí sửa chữa xe hơi",
  "Mua vé tham dự khóa học",
  "Chi phí bảo trì thiết bị",
  "Gửi tiền cho quỹ khuyến học",
  "Mua sắm đồ dùng thể thao",
  "Chi phí tổ chức kỷ niệm",
  "Đặt cọc mua vé concert",
  "Mua vé xem phim online",
  "Chi phí mua sắm thiết bị văn phòng",
  "Nhận tiền từ hoạt động đầu tư",
  "Gửi tiền cho tổ chức bảo trợ xã hội",
  "Mua sắm đồ dùng học sinh",
  "Chi phí bảo trì máy tính",
  "Mua vé tham gia hội nghị",
  "Chi phí mua sắm thiết bị bất động sản",
  "Gửi tiền cho quỹ hỗ trợ cộng đồng",
  "Mua sắm đồ dùng cho văn phòng",
  "Chi phí tổ chức tiệc tùng",
  "Mua vé xem thể thao trực tiếp",
  "Chi phí thuê dịch vụ tư vấn",
  "Nhận tiền từ hợp đồng dịch vụ",
  "Gửi tiền cho tổ chức phi chính phủ",
  "Mua sắm đồ dùng cho trường học",
  "Chi phí bảo trì đường ống",
  "Mua vé tham dự sự kiện nghệ thuật",
  "Chi phí mua sắm thiết bị công nghệ thông tin",
  "Gửi tiền cho tổ chức môi trường",
  "Mua sắm đồ dùng cho cơ sở sản xuất",
  "Chi phí tổ chức buổi họp",
  "Mua vé xem chương trình truyền hình",
  "Chi phí bảo trì hệ thống máy tính",
  "Nhận tiền từ việc làm tự do",
  "Gửi tiền cho quỹ bảo trợ xã hội",
  "Mua sắm thiết bị cho văn phòng",
  "Chi phí tổ chức buổi tiệc",
  "Mua vé tham dự buổi hòa nhạc",
  "Chi phí mua sắm thiết bị gia đình",
  "Gửi tiền cho tổ chức thể thao",
  "Mua sắm đồ dùng cho nhà bếp",
  "Chi phí bảo trì thiết bị điện tử",
  "Mua vé tham dự sự kiện văn hóa",
  "Chi phí tổ chức buổi kỷ niệm",
  "Nhận tiền từ đầu tư bất động sản",
  "Gửi tiền cho tổ chức văn hóa nghệ thuật",
  "Mua sắm đồ dùng cho phòng khách",
  "Chi phí mua sắm thiết bị chăm sóc sức khỏe",
  "Mua vé xem phim tại nhà",
  "Chi phí tổ chức buổi lễ",
  "Nhận tiền từ các hoạt động kinh doanh",
  "Gửi tiền cho quỹ hỗ trợ học sinh",
  "Mua sắm đồ dùng cho lớp học",
  "Chi phí bảo trì hệ thống điện nước",
  "Mua vé tham gia lễ hội",
  "Chi phí mua sắm thiết bị gia đình",
  "Gửi tiền cho tổ chức bảo vệ động vật",
  "Mua sắm đồ dùng cho nhà vệ sinh",
];

const notes = [
  "Lương tháng 1 đã được chuyển khoản vào tài khoản cá nhân.",
  "Hóa đơn tiền điện tháng này cao hơn tháng trước do sử dụng điều hòa nhiều.",
  "Đã mua laptop từ trang thương mại điện tử, đang chờ giao hàng.",
  "Rút tiền mặt tại ATM gần nhà.",
  "Nạp tiền điện thoại để sử dụng dịch vụ gọi và nhắn tin.",
  "Chuyển khoản giữa các tài khoản trong cùng ngân hàng.",
  "Khách hàng đã thanh toán tiền sản phẩm qua chuyển khoản.",
  "Trả góp điện thoại kỳ thứ 3 trên tổng số 12 kỳ.",
  "Đã mua vé máy bay cho chuyến đi du lịch hè.",
  "Thanh toán tiền nước tháng này cho công ty cấp nước địa phương.",
  "Gửi tiền vào tài khoản tiết kiệm kỳ hạn 12 tháng.",
  "Nhận thưởng cuối năm từ công ty do đạt thành tích xuất sắc.",
  "Chi phí tiếp khách đối tác quan trọng trong dự án mới.",
  "Thanh toán dư nợ thẻ tín dụng trước hạn để tránh lãi suất.",
  "Đầu tư vào quỹ mở để đa dạng hóa danh mục đầu tư.",
  "Mua bảo hiểm nhân thọ để bảo vệ tài chính gia đình.",
  "Gia hạn gói hội viên phòng gym trong 6 tháng tiếp theo.",
  "Trả lãi suất vay ngân hàng định kỳ hàng tháng.",
  "Nhận hoa hồng từ việc giới thiệu khách hàng mới.",
  "Chi phí du lịch hè cùng gia đình tại Đà Nẵng.",
  "Thanh toán tiền cước internet và truyền hình cáp.",
  "Nạp tiền vào ví điện tử để sử dụng dịch vụ tiện ích.",
  "Mua laptop mới để phục vụ công việc và học tập.",
  "Thanh toán phí bảo trì xe ô tô định kỳ.",
  "Nhận trợ cấp từ bố mẹ để hỗ trợ sinh hoạt phí.",
  "Trả tiền thuê nhà tháng này đúng hạn.",
  "Mua cổ phiếu công ty công nghệ tiềm năng.",
  "Nhận tiền hoàn thuế thu nhập cá nhân từ cơ quan thuế.",
  "Đóng bảo hiểm xe máy để đảm bảo an toàn khi tham gia giao thông.",
  "Mua sắm đồ dùng gia đình tại siêu thị.",
  "Thanh toán phí bảo hiểm sức khỏe cho năm tiếp theo.",
  "Nhận tiền đặt cọc từ người thuê nhà.",
  "Thanh toán học phí kỳ mới tại trường đại học.",
  "Trả phí sử dụng phần mềm kế toán cho doanh nghiệp.",
  "Chi tiêu mua thực phẩm cho cả gia đình trong tháng.",
  "Thanh toán chi phí khám chữa bệnh tại bệnh viện.",
  "Đầu tư vào một dự án bất động sản mới.",
  "Thanh toán cước taxi cho chuyến đi công tác.",
  "Rút tiền mặt tại quầy giao dịch ngân hàng.",
  "Giao dịch mua bán ngoại tệ để đầu tư.",
  "Trả phí bảo trì chung cư hàng tháng.",
  "Nhận tiền bồi thường bảo hiểm từ công ty bảo hiểm.",
  "Chi phí chạy quảng cáo trên mạng xã hội.",
  "Mua sách tham khảo và tài liệu học tập online.",
  "Gia hạn dịch vụ xem phim trực tuyến.",
  "Gửi tiền mừng đám cưới bạn thân.",
  "Mua vé xem phim cuối tuần cùng gia đình.",
  "Mua thẻ quà tặng để tặng bạn bè dịp sinh nhật.",
  "Đặt cọc thuê xe tự lái cho chuyến du lịch.",
  "Mua quần áo mới chuẩn bị cho mùa hè.",
];

function getRandomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

function getRandomElement(array) {
  return array[getRandomInt(0, array.length - 1)];
}

function generateRandomDate(minYear, maxYear) {
  const randomPastYear = getRandomInt(minYear, maxYear);
  const randomMonth = getRandomInt(1, 12).toString().padStart(2, "0");
  const randomDay = getRandomInt(1, 28).toString().padStart(2, "0");
  const randomHour = getRandomInt(0, 23).toString().padStart(2, "0");
  const randomMinute = getRandomInt(0, 59).toString().padStart(2, "0");
  const randomSecond = getRandomInt(0, 59).toString().padStart(2, "0");
  return `${randomDay}/${randomMonth}/${randomPastYear} ${randomHour}:${randomMinute}:${randomSecond}`;
}

function genTransactionName(type = "expense") {
  const actions = {
    income: [
      "Nhận tiền",
      "Được chuyển khoản",
      "Hoàn tiền",
      "Tiền thưởng",
      "Thu nhập từ",
      "Tiền hoàn trả",
      "Nhận lãi suất",
      "Thu nhập đầu tư",
      "Tiền bán hàng",
      "Tiền hỗ trợ",
    ],
    expense: [
      "Thanh toán",
      "Chi trả",
      "Mua",
      "Đóng phí",
      "Trả tiền",
      "Chi cho",
      "Đặt hàng",
      "Đầu tư vào",
      "Chuyển khoản đến",
      "Đặt cọc cho",
    ],
    transfer: [
      "Chuyển tiền",
      "Rút tiền",
      "Nạp tiền",
      "Chuyển khoản",
      "Chuyển nội bộ",
      "Gửi tiền",
    ],
  };

  const targets = {
    income: [
      "lương tháng",
      "khách hàng",
      "công ty",
      "đối tác",
      "ngân hàng",
      "bảo hiểm",
      "bán tài sản",
      "người thân",
      "cổ tức",
      "thu nhập phụ",
    ],
    expense: [
      "điện",
      "nước",
      "internet",
      "mua hàng online",
      "tiền nhà",
      "tiền học",
      "xăng xe",
      "dịch vụ streaming",
      "mua đồ ăn",
      "tiền khám bệnh",
      "dịch vụ ngân hàng",
      "du lịch",
      "quà tặng",
      "phí bảo trì",
      "mua quần áo",
      "đi taxi",
    ],
    transfer: [
      "tài khoản phụ",
      "ví điện tử",
      "ATM",
      "ngân hàng ACB",
      "người thân",
      "đồng nghiệp",
    ],
  };

  const suffixes = {
    income: [
      "",
      "tháng 5",
      "tháng này",
      "từ công việc freelance",
      "cuối năm",
      "từ hợp đồng ABC",
    ],
    expense: [
      "",
      "tháng 5",
      "cuối tháng",
      "cho gia đình",
      "theo định kỳ",
      "khi đi du lịch",
    ],
    transfer: ["", "ngày hôm nay", "gấp", "cho mục đích cá nhân", "tháng này"],
  };

  const actionList = actions[type] || actions.expense;
  const targetList = targets[type] || targets.expense;
  const suffixList = suffixes[type] || [];

  const action = actionList[Math.floor(Math.random() * actionList.length)];
  const target = targetList[Math.floor(Math.random() * targetList.length)];
  const suffix = suffixList[Math.floor(Math.random() * suffixList.length)];

  return `${action} ${target} ${suffix}`.trim();
}

function generateRandomData(count) {
  const set = new Set();
  while (set.size < count) {
    const types = ["income", "expense", "transfer"];
    const type = types[Math.floor(Math.random() * types.length)];
    const name = genTransactionName(type);
    const kind = getRandomInt(1, 2);
    const isApproved = getRandomInt(0, 1);
    const approvedBy = isApproved == 1 ? getRandomElement(employeeIds) : "";
    const categoryId =
      kind == 1
        ? getRandomElement(categoryIds.income)
        : getRandomElement(categoryIds.expense);
    set.add({
      addedBy: getRandomElement(employeeIds),
      approvedBy,
      categoryId,
      ignoreDebit: getRandomInt(0, 1),
      kind,
      money: getRandomInt(100000, 100000000),
      name,
      note: getRandomElement(notes),
      tagId: getRandomElement(tagIds),
      transactionDate: generateRandomDate(2000, 2025),
      transactionGroupId: getRandomElement(transactionGroupIds),
    });
  }
  return [...set];
}

function jsonToCsv(data) {
  const headers = Object.keys(data[0]);
  const rows = data.map((row) =>
    headers.map((header) => `"${row[header]}"`).join(",")
  );
  return [headers.join(","), ...rows].join("\n");
}

function saveToCsv(count, fileName) {
  const data = generateRandomData(count);
  const csvContent = jsonToCsv(data);
  fs.writeFileSync(fileName, csvContent, "utf8");
  console.log(`File CSV đã được tạo: ${fileName}`);
}

const count = 2000;
const timestamp = new Date().toISOString().replace(/[-T:.Z]/g, "");
const fileName = `transaction_${timestamp}.csv`;
saveToCsv(count, fileName);
