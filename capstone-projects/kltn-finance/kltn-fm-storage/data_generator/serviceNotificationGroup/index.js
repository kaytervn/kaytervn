const fs = require("fs");

const serviceIds = [
  8527838063165440, 8527838054678528, 8527838049959936, 8527838045601792,
  8527838035345408, 8527838030036992, 8527838024466432, 8527838018535424,
  8527838000513024, 8527837986652160, 8527837964828672, 8527837968859136,
  8527837978525696, 8527837959684096, 8527837954211840, 8527837925408768,
  8527837920165888, 8527837909155840, 8527837883760640, 8527837888806912,
  8527837893328896, 8527837857316864, 8527837852991488, 8527837848633344,
  8527837843521536, 8527837837950976, 8527837832216576, 8527837810098176,
  8527837816225792, 8527837827170304, 8527837797384192, 8527837780148224,
  8527837774938112, 8527837769859072, 8527837765337088, 8527837760487424,
  8527837755277312, 8527837744529408, 8527837739679744, 8527837706813440,
  8527837715464192, 8527837732241408, 8527837701308416, 8527837692690432,
  8527837687021568, 8527837678796800, 8527837673095168, 8527837652221952,
  8527837646815232, 8527837641572352, 8527837631119360, 8527837605134336,
  8527837617815552, 8527837621944320, 8527837626564608, 8527837635117056,
  8527837594615808, 8527837580132352, 8527837571186688, 8527837537239040,
  8527837549527040, 8527837554540544, 8527837565911040, 8527837560569856,
  8527837528293376, 8527837506142208, 8527837501095936, 8527837492477952,
  8527837486743552, 8527837479927808, 8527837450403840, 8527837455810560,
  8527837459873792, 8527837468557312, 8527837433659392, 8527837422354432,
  8527837414293504, 8527837409804288, 8527837402169344, 8527837397680128,
  8527837390012416, 8527837384572928, 8527837379264512, 8527837349937152,
  8527837367599104, 8527837356687360, 8527837340631040, 8527837345611776,
  8527837315006464, 8527837322117120, 8527837330472960, 8527837336436736,
  8527837279813632, 8527837289283584, 8527837299507200, 8527837305962496,
  8527837244194816, 8527837255565312, 8527837263036416, 8527837267722240,
  8527837273784320, 8527837214572544, 8527837227122688, 8527837234462720,
  8527837239181312, 8527837179019264, 8527837184032768, 8527837188685824,
  8527837194452992, 8527837203103744, 8527837207592960, 8527837149167616,
  8527837171318784, 8527837115121664, 8527837119217664, 8527837123936256,
  8527837129244672, 8527837137043456, 8527837083435008, 8527837088612352,
  8527837093756928, 8527837097984000, 8527837102735360, 8527837107552256,
  8527837048897536, 8527837054009344, 8527837058301952, 8527837067313152,
  8527837014163456, 8527837026680832, 8527837031432192, 8527837039722496,
  8527837044211712, 8527836992405504, 8527836997419008, 8527836951445504,
  8527836956295168, 8527836964552704, 8527836970090496, 8527836917334016,
  8527836927262720, 8527836931784704, 8527836884238336, 8527836888498176,
  8527836894265344, 8527836899147776, 8527836904849408, 8527836912877568,
  8527836851896320, 8527836857630720, 8527836876963840, 8527836816900096,
  8527836828532736, 8527836835643392, 8527836840689664, 8527836801794048,
  8527836806774784, 8527836753952768, 8527836759097344, 8527836769157120,
  8527836773810176, 8527836726624256, 8527836737306624, 8527836743270400,
  8527836686680064, 8527836691824640, 8527836697034752, 8527836702507008,
  8527836707520512, 8527836712501248, 8527836655190016, 8527836662628352,
  8527836668035072, 8527836676194304, 8527836681404416, 8527836623831040,
  8527836630646784, 8527836635070464, 8527836640739328, 8527836593782784,
  8527836604137472, 8527836609118208, 8527836614131712, 8527836618850304,
  8527836555116544, 8527836563767296, 8527836569600000, 8527836581593088,
  8527836521627648, 8527836525756416, 8527836530638848, 8527836537225216,
  8527836545417216, 8527836549939200, 8527836489842688, 8527836495675392,
  8527836515237888, 8527836462645248, 8527836475949056, 8527836480995328,
  8527836439478272, 8527836443705344, 8527836448325632, 8527836452421632,
  8527836394127360, 8527836402155520, 8527836407857152, 8527836413296640,
  8527836421521408, 8527836371648512, 8527836381478912, 8527836385542144,
  8527836324724736, 8527836329902080, 8527836334915584, 8527836348514304,
  8527836356575232, 8527836300640256, 8527836309684224, 8527836314533888,
  8527836319350784, 8527836272230400, 8527836277833728, 8527836285239296,
  8527836233826304, 8527836239527936, 8527836244148224, 8527836248670208,
  8527836253683712, 8527836258533376, 8527836196012032, 8527836200632320,
  8527836206366720, 8527836217344000, 8527836161572864, 8527836173631488,
  8527836179857408, 8527836184969216, 8527836190572544, 8527836129722368,
  8527836138831872, 8527836143386624, 8527836098920448, 8527836109963264,
  8527836113960960, 8527836119040000, 8527836124053504, 8527836066938880,
  8527836072345600, 8527836076769280, 8527836081389568, 8527836032991232,
  8527836040986624, 8527836045705216, 8527836056223744, 8527836061761536,
  8527836000649216, 8527836005203968, 8527836018737152, 8527836029026304,
  8527835967160320, 8527835974696960, 8527835982364672, 8527835987836928,
  8527835992489984, 8527835935440896, 8527835940487168, 8527835953135616,
  8527835898740736, 8527835907162112, 8527835912110080, 8527835916337152,
  8527835921383424, 8527835928395776, 8527835870068736, 8527835884191744,
  8527835837530112, 8527835843264512, 8527835847327744, 8527835855454208,
  8527835860467712, 8527835865513984, 8527835812298752, 8527835821867008,
  8527835827601408, 8527835832418304, 8527835768389632, 8527835773042688,
  8527835780218880, 8527835794014208, 8527835799060480, 8527835744043008,
  8527835753938944, 8527835758854144, 8527835763277824, 8527835704328192,
  8527835708391424, 8527835713110016, 8527835718975488, 8527835722907648,
  8527835727921152, 8527835682439168, 8527835692466176, 8527835697315840,
  8527835638235136, 8527835644231680, 8527835649474560, 8527835654422528,
  8527835660025856, 8527835665137664, 8527835609366528, 8527835622998016,
  8527835627585536, 8527835632795648, 8527835578040320, 8527835582529536,
  8527835587608576, 8527835592589312, 8527835597438976, 8527835546583040,
  8527835553103872, 8527835559264256, 8527835563720704, 8527835568865280,
  8527835511685120, 8527835516796928, 8527835521810432, 8527835525349376,
  8527835529936896, 8527835472855040, 8527835481571328, 8527835487010816,
  8527835491762176, 8527835495727104, 8527835503001600, 8527835442905088,
  8527835449065472, 8527835457486848, 8527835409874944, 8527835417149440,
  8527835422195712, 8527835427274752, 8527835432452096, 8527835437891584,
  8527835377434624, 8527835382415360, 8527835386052608, 8527835401814016,
  8527835342176256, 8527835347288064, 8527835352268800, 8527835359576064,
  8527835364622336, 8527835369635840, 8527835311210496, 8527835316387840,
  8527835320975360, 8527835335622656, 8527835280801792, 8527835286503424,
  8527835291975680, 8527835299512320, 8527835304198144, 8527835244003328,
  8527835248885760, 8527835262156800, 8527835271331840, 8527835275821056,
  8527835214839808, 8527835220475904, 8527835226046464, 8527835234140160,
  8527835239415808, 8527835190755328, 8527835202256896, 8527835207696384,
  8527835149369344, 8527835154874368, 8527835160936448, 8527835165589504,
  8527835171323904, 8527835113750528, 8527835127283712, 8527835133706240,
  8527835138785280, 8527835084619776, 8527835089797120, 8527835093467136,
  8527835099103232, 8527835103264768, 8527835107852288, 8527835047002112,
  8527835067383808, 8527835072004096, 8527835076984832, 8527835022065664,
  8527835027177472, 8527835032748032, 8527835037859840, 8527835043397632,
  8527834995097600, 8527835001389056, 8527835007090688, 8527835011645440,
  8527834949353472, 8527834954563584, 8527834959249408, 8527834965377024,
  8527834969931776, 8527834974814208, 8527834979958784, 8527834925793280,
  8527834935721984, 8527834943913984, 8527834883588096, 8527834891845632,
  8527834896564224, 8527834901020672, 8527834910818304, 8527834852622336,
  8527834863697920, 8527834869235712, 8527834879033344, 8527834818314240,
  8527834826080256, 8527834831454208, 8527834836828160, 8527834784923648,
  8527834794786816, 8527834799538176, 8527834804158464, 8527834808811520,
  8527834813759488, 8527834753695744, 8527834763001856, 8527834768605184,
  8527834773716992, 8527834722795520, 8527834728890368, 8527834733838336,
  8527834741407744, 8527834748583936, 8527834689765376, 8527834696941568,
  8527834702249984, 8527834661683200, 8527834666434560, 8527834671382528,
  8527834676199424, 8527834681442304, 8527834622164992, 8527834626686976,
  8527834632814592, 8527834650705920, 8527834597163008, 8527834601848832,
  8527834606010368, 8527834611548160, 8527834617053184, 8527834555514880,
  8527834560987136, 8527834569179136, 8527834583957504, 8527834527498240,
  8527834535493632, 8527834540867584, 8527834545848320, 8527834551517184,
  8527834491092992, 8527834496532480, 8527834515570688, 8527834521731072,
  8527834459111424, 8527834463830016, 8527834469531648, 8527834474971136,
  8527834481033216, 8527834485981184, 8527834426376192, 8527834431553536,
  8527834446036992, 8527834454654976, 8527834396852224, 8527834401243136,
  8527834405502976, 8527834411532288, 8527834417037312, 8527834421100544,
  8527834361462784, 8527834370867200, 8527834381385728, 8527834390626304,
  8527834326663168, 8527834331545600, 8527834336624640, 8527834341867520,
  8527834347143168, 8527834351796224, 8527834356449280, 8527834296680448,
  8527834308509696, 8527834317651968, 8527834322468864, 8527834263945216,
  8527834268794880, 8527834273939456, 8527834278461440, 8527834286718976,
  8527834291568640, 8527834242711552, 8527834247757824, 8527834253361152,
  8527834258407424, 8527834194804736, 8527834201423872, 8527834207289344,
  8527834216955904, 8527834221510656, 8527834227212288, 8527834165444608,
  8527834172981248, 8527834177765376, 8527834182287360, 8527834189987840,
  8527834129629184, 8527834135560192, 8527834140114944, 8527834145062912,
  8527834150240256, 8527834098270208, 8527834102759424, 8527834107805696,
  8527834113343488, 8527834118356992, 8527834122813440, 8527834065403904,
  8527834070122496, 8527834075660288, 8527834081132544, 8527834032013312,
  8527834036633600, 8527834044301312, 8527834048823296, 8527834053836800,
  8527834059505664, 8527834002980864, 8527834008059904, 8527834023460864,
  8527833966903296, 8527833972113408, 8527833977683968, 8527833982697472,
  8527833987809280, 8527833993150464, 8527833998000128, 8527833933512704,
  8527833949110272, 8527833956941824, 8527833961529344, 8527833902678016,
  8527833907658752, 8527833912737792, 8527833918767104, 8527833927811072,
  8527833868959744, 8527833874268160, 8527833879576576, 8527833885016064,
  8527833889570816, 8527833893666816, 8527833898188800, 8527833842614272,
  8527833849397248, 8527833854083072, 8527833859194880, 8527833863323648,
  8527833803456512, 8527833808076800, 8527833812434944, 8527833818038272,
  8527833823281152, 8527833827868672, 8527833769771008, 8527833778421760,
  8527833784123392, 8527833792774144, 8527833798475776, 8527833736249344,
  8527833740115968, 8527833745129472, 8527833749749760, 8527833754730496,
  8527833704202240, 8527833709969408, 8527833715376128, 8527833720979456,
  8527833726025728, 8527833731563520, 8527833675366400, 8527833679396864,
  8527833683656704, 8527833698533376, 8527833641582592, 8527833647054848,
  8527833652199424, 8527833657376768, 8527833662881792, 8527833670352896,
  8527833608617984, 8527833625395200, 8527833633325056, 8527833576964096,
  8527833581486080, 8527833585188864, 8527833589317632, 8527833594429440,
  8527833603211264, 8527833557958656, 8527833566150656, 8527833571328000,
  8527833510019072, 8527833514704896, 8527833518800896, 8527833523224576,
  8527833527812096, 8527833532956672, 8527833538494464, 8527833488261120,
  8527833495404544, 8527833500483584, 8527833505136640, 8527833444909056,
  8527833450053632, 8527833455230976, 8527833460310016, 8527833465683968,
  8527833469452288, 8527833473351680, 8527833415614464, 8527833423937536,
  8527833427312640, 8527833431375872, 8527833436389376, 8527833440452608,
  8527833379307520, 8527833384288256, 8527833389891584, 8527833394970624,
  8527833401098240, 8527833349259264, 8527833359974400, 8527833365282816,
  8527833369313280, 8527833374228480, 8527833313673216, 8527833318260736,
  8527833322684416, 8527833330778112, 8527833336053760, 8527833282117632,
  8527833289916416, 8527833296928768, 8527833301417984, 8527833306660864,
  8527833248890880, 8527833252462592, 8527833257082880, 8527833272221696,
  8527833277038592, 8527833214189568, 8527833219039232, 8527833224216576,
  8527833229426688, 8527833234112512, 8527833238241280, 8527833243385856,
  8527833182535680, 8527833193807872, 8527833204195328, 8527833209602048,
  8527833150717952, 8527833154781184, 8527833160187904, 8527833164840960,
  8527833169887232, 8527833177522176, 8527833117982720, 8527833129975808,
  8527833139511296, 8527833144754176, 8527833084985344, 8527833090260992,
  8527833096126464, 8527833101598720, 8527833108676608, 8527833112772608,
  8527833050447872, 8527833061818368, 8527833070436352, 8527833074040832,
  8527833078824960, 8527833018499072, 8527833023119360, 8527833027870720,
  8527833035079680, 8527833040289792, 8527833044385792, 8527832985141248,
  8527832990253056, 8527833005490176, 8527833013125120, 8527832953126912,
  8527832957288448, 8527832962039808, 8527832966070272, 8527832970559488,
  8527832976621568, 8527832981143552, 8527832928714752, 8527832937594880,
  8527832942084096, 8527832947654656, 8527832885166080, 8527832891129856,
  8527832896602112, 8527832902074368, 8527832905777152, 8527832910888960,
  8527832915836928, 8527832861638656, 8527832866258944, 8527832871239680,
  8527832875302912, 8527832880709632, 8527832823103488, 8527832827625472,
  8527832833458176, 8527832837980160, 8527832842502144, 8527832847155200,
  8527832793907200, 8527832803377152, 8527832808554496, 8527832813404160,
  8527832818155520, 8527832756781056, 8527832761499648, 8527832766742528,
  8527832772345856, 8527832778047488, 8527832782897152, 8527832729354240,
  8527832736890880, 8527832742166528, 8527832748097536, 8527832752652288,
  8527832691146752, 8527832695930880, 8527832701370368, 8527832706940928,
  8527832712085504, 8527832716673024, 8527832665587712, 8527832672698368,
  8527832677580800, 8527832682692608, 8527832622727168, 8527832628461568,
  8527832632688640, 8527832637865984, 8527832642191360, 8527832646352896,
  8527832590188544, 8527832595070976, 8527832599527424, 8527832604049408,
  8527832608538624, 8527832612044800, 8527832618139648, 8527832560107520,
  8527832565481472, 8527832580653056, 8527832549294080, 8527832555257856,
  8340952721915904, 8340952697470976, 8340952673910784, 8340952625250304,
  8340952651038720, 8340952601788416, 8340952578785280, 8340952530878464,
  8340952556175360, 8340952508104704, 8340952485199872, 8340952401805312,
  8340952424448000, 8340952378867712, 8340952328044544, 8340952353701888,
  8340952300650496, 8340952276434944, 8340952252809216, 8340952198086656,
  8340952225644544, 8340952167284736, 8340952123408384, 8340952080613376,
  8340952034050048, 8340952057184256, 8340952005672960, 8340951979786240,
  8340951947083776, 8340951920279552, 8340951872503808, 8340951895900160,
  8340951848550400, 8340951806607360, 8340951758077952, 8340951710072832,
  8340951735205888, 8340951684546560, 8340951648403456, 8340951622320128,
  8340951574577152, 8340951600267264, 8340951550328832, 8340951522705408,
  8340951487873024, 8340951411294208, 8340951433773056, 8340951389208576,
  8340951363584000, 8340951311777792, 8340951337926656, 8340951282581504,
  8340951259578368, 8340951235100672, 8340951211016192, 8340951165894656,
  8340951084892160, 8340951113072640, 8340951059595264, 8340951034691584,
  8340950988390400, 8340951012933632, 8340950964109312, 8340950918955008,
  8340950941007872, 8340950892675072, 8340950867247104, 8340950808231936,
  8340950768025600, 8340950722314240, 8340950744727552, 8340950694658048,
  8340950670409728, 8340950643408896, 8340950591963136, 8340950616604672,
  8340950567780352, 8340950544941056, 8340950521315328, 8340950461480960,
  8340950430384128, 8340950408298496, 8340950381821952, 8340950331162624,
  8340950354132992, 8340950308880384, 8340950285025280, 8340950262218752,
  8340950200451072, 8340950226173952, 8340950149136384, 8340950108209152,
  8340950080913408, 8340950044475392, 8340950020882432, 8340949986181120,
  8340949923594240, 8330122733256704, 8329737631629312, 8329733626036224,
  8329676627869696, 8329488488595456,
];

const notificationGroupIds = [
  8324180885700608, 8330222439464960, 8340929654292480, 8340929662943232,
  8340929669758976, 8340929676410880, 8340929684668416, 8340929691910144,
  8340929699086336, 8340929707114496, 8340929714356224, 8340929722613760,
  8340929729986560, 8340929738145792, 8340929745813504, 8340929752596480,
  8340929758068736, 8340929764851712, 8340929770717184, 8340929776844800,
  8340929783988224, 8340929802403840, 8340929821704192, 8340929841594368,
  8340929856274432, 8340929864040448, 8340929873674240, 8340929883504640,
  8340929890844672, 8340929897922560, 8340929905360896, 8340929913126912,
  8340929919320064, 8340929925971968, 8340929932558336, 8340929939865600,
  8340929945403392, 8340929951956992, 8340929958608896, 8340929964933120,
  8340929970831360, 8340929977417728, 8340929985740800, 8340929993768960,
  8340930001436672, 8340930008121344, 8340930015395840, 8340930022965248,
];

function shuffleArray(arr) {
  return arr
    .map((value) => ({ value, sort: Math.random() }))
    .sort((a, b) => a.sort - b.sort)
    .map(({ value }) => value);
}

function generateAccountGroupPairs(accountIds, groupIds, ratio = 0.7) {
  const result = [];

  accountIds.forEach((accountId) => {
    const shuffled = shuffleArray(groupIds);
    const groupCount = Math.floor(groupIds.length * ratio);
    const selected = shuffled.slice(0, groupCount);

    selected.forEach((groupId) => {
      result.push({ serviceId: accountId, notificationGroupId: groupId });
    });
  });

  return result;
}

function jsonToCsv(data) {
  const headers = Object.keys(data[0]);
  const rows = data.map((row) =>
    headers.map((header) => `"${row[header]}"`).join(",")
  );
  return [headers.join(","), ...rows].join("\n");
}

function saveToCsv(fileName, data) {
  const csvContent = jsonToCsv(data);
  fs.writeFileSync(fileName, csvContent, "utf8");
  console.log(`File CSV đã được tạo: ${fileName}`);
}

const pairs = generateAccountGroupPairs(serviceIds, notificationGroupIds, 0.2);
const timestamp = new Date().toISOString().replace(/[-T:.Z]/g, "");
const fileName = `service_group_notification_${timestamp}.csv`;
saveToCsv(fileName, pairs);
