const fs = require("fs");

const accountIds = [
  8313653263695872, 8320740878581760, 8340623243018240, 8340623268478976,
  8340623292366848, 8340623315599360, 8340623342403584, 8340623382085632,
  8340623409840128, 8340623438053376, 8340623473246208, 8340623495036928,
  8340623523217408, 8340623553691648, 8340623575252992, 8340623595995136,
  8340623616966656, 8340623647571968, 8340623681912832, 8340623704227840,
  8340623736209408, 8340623760031744, 8340623786475520, 8340623821406208,
  8340623848865792, 8340623874719744,
];

const projectIds = [
  8324561646682112, 8324807362117632, 8340725720580096, 8340725742698496,
  8340725783625728, 8340725800992768, 8340725816852480, 8340725834350592,
  8340725870362624, 8340725901361152, 8340725919350784, 8340725935472640,
  8340725954445312, 8340725973712896, 8340725994782720, 8340726013001728,
  8340726063431680, 8340726122414080, 8340726139420672, 8340726158098432,
  8340726183821312, 8340726226190336, 8340726243328000, 8340726260006912,
  8340726279143424, 8340726296641536, 8340726313123840, 8340726330949632,
  8340726347726848, 8340726365683712, 8340726382559232, 8340726398910464,
  8340726420701184, 8340726436855808, 8340726457139200, 8340726472900608,
  8340726490202112, 8340726520578048, 8340726556000256, 8340726586179584,
  8340726604627968, 8340726806937600, 8340727016816640, 8340727035199488,
  8340727052468224, 8340727069212672, 8340727088775168, 8340727126261760,
  8340727308419072, 8340727533174784, 8340727566991360, 8340727583834112,
  8344175839412224, 8489634073509888, 8489634835267584, 8489636543922176,
  8519218983960576, 8519219419873280, 8527889534713856, 8527889538973696,
  8527889544216576, 8527889548836864, 8527889553031168, 8527889559322624,
  8527889563910144, 8527889567940608, 8527889572626432, 8527889577738240,
  8527889582718976, 8527889601069056, 8527889607950336, 8527889614471168,
  8527889620467712, 8527889625776128, 8527889632002048, 8527889637343232,
  8527889643864064, 8527889649041408, 8527889653989376, 8527889659559936,
  8527889664376832, 8527889669718016, 8527889674567680, 8527889678991360,
  8527889683906560, 8527889689182208, 8527889694097408, 8527889699962880,
  8527889704812544, 8527889710186496, 8527889730273280, 8527889736433664,
  8527889743118336, 8527889747968000, 8527889752489984, 8527889757700096,
  8527889762582528, 8527889766580224, 8527889771823104, 8527889777655808,
  8527889782734848, 8527889789419520, 8527889794301952, 8527889799512064,
  8527889804853248, 8527889809375232, 8527889825955840, 8527889831034880,
  8527889838669824, 8527889843224576, 8527889847713792, 8527889852334080,
  8527889860624384, 8527889865572352, 8527889869504512, 8527889874681856,
  8527889879826432, 8527889884708864, 8527889889361920, 8527889895096320,
  8527889903714304, 8527889921441792, 8527889928126464, 8527889932484608,
  8527889937039360, 8527889942642688, 8527889947721728, 8527889951784960,
  8527889959092224, 8527889964040192, 8527889969545216, 8527889974984704,
  8527889991172096, 8527890000248832, 8527890006343680, 8527890012307456,
  8527890017222656, 8527890023972864, 8527890029019136, 8527890033999872,
  8527890039242752, 8527890044747776, 8527890051858432, 8527890071846912,
  8527890081316864, 8527890086232064, 8527890090852352, 8527890095898624,
  8527890100977664, 8527890106515456, 8527890110545920, 8527890115592192,
  8527890121457664, 8527890126143488, 8527890140364800, 8527890149834752,
  8527890155405312, 8527890160615424, 8527890164908032, 8527890169888768,
  8527890175328256, 8527890180014080, 8527890185519104, 8527890190925824,
  8527890195677184, 8527890212290560, 8527890227232768, 8527890232901632,
  8527890237685760, 8527890243518464, 8527890248663040, 8527890254626816,
  8527890259542016, 8527890264031232, 8527890269962240, 8527890287984640,
  8527890295619584, 8527890304630784, 8527890309775360, 8527890314821632,
  8527890322817024, 8527890327764992, 8527890333433856, 8527890339102720,
  8527890343919616, 8527890349096960, 8527890365251584, 8527890373869568,
  8527890378981376, 8527890384617472, 8527890389663744, 8527890394316800,
  8527890398347264, 8527890403622912, 8527890408734720, 8527890412929024,
  8527890416959488, 8527890422005760, 8527890426724352, 8527890442125312,
  8527890457198592, 8527890462736384, 8527890467520512, 8527890472271872,
  8527890477154304, 8527890481840128, 8527890486296576, 8527890491998208,
  8527890497437696, 8527890514542592, 8527890524012544, 8527890533744640,
  8527890540724224, 8527890545442816, 8527890550521856, 8527890556059648,
  8527890561007616, 8527890565627904, 8527890569658368, 8527890575130624,
  8527890583912448, 8527890596364288, 8527890611208192, 8527890616778752,
  8527890621530112, 8527890627362816, 8527890631852032, 8527890636406784,
  8527890641485824, 8527890647449600, 8527890652987392, 8527890658656256,
  8527890663669760, 8527890680250368, 8527890692734976, 8527890700369920,
  8527890705055744, 8527890710200320, 8527890715377664, 8527890721046528,
  8527890726191104, 8527890731597824, 8527890737233920, 8527890743099392,
  8527890764070912, 8527890772000768, 8527890776850432, 8527890781437952,
  8527890785959936, 8527890791038976, 8527890797068288, 8527890802704384,
  8527890808373248, 8527890813452288, 8527890818433024, 8527890838257664,
  8527890846482432, 8527890853298176, 8527890858967040, 8527890866634752,
  8527890872172544, 8527890877054976, 8527890882592768, 8527890887540736,
  8527890892357632, 8527890896715776, 8527890910019584, 8527890920603648,
  8527890925518848, 8527890932432896, 8527890936922112, 8527890942033920,
  8527890946457600, 8527890951700480, 8527890956681216, 8527890961760256,
  8527890966773760, 8527890972475392, 8527890977718272, 8527890995019776,
  8527891007569920, 8527891016810496, 8527891021398016, 8527891027034112,
  8527891034243072, 8527891042369536, 8527891050856448, 8527891056001024,
  8527891061112832, 8527891077595136, 8527891084541952, 8527891093487616,
  8527891099287552, 8527891104202752, 8527891109412864, 8527891116359680,
  8527891124551680, 8527891130155008, 8527891138674688, 8527891146768384,
  8527891178094592, 8527891182485504, 8527891188711424, 8527891194249216,
  8527891200409600, 8527891212107776, 8527891217121280, 8527891223281664,
  8527891236880384, 8527891252936704, 8527891262504960, 8527891267452928,
  8527891273482240, 8527891281674240, 8527891287539712, 8527891292553216,
  8527891299991552, 8527891303956480, 8527891312279552, 8527891316965376,
  8527891323092992, 8527891327254528, 8527891333382144, 8527891341213696,
  8527891348684800, 8527891353239552, 8527891363364864, 8527891371491328,
  8527891389710336, 8527891406979072, 8527891411435520, 8527891420151808,
  8527891424083968, 8527891428966400, 8527891437289472, 8527891442008064,
  8527891449413632, 8527891454623744, 8527891471171584, 8527891479429120,
  8527891486212096, 8527891491848192, 8527891497189376, 8527891501547520,
  8527891506429952, 8527891510689792, 8527891514753024, 8527891520454656,
  8527891525337088, 8527891536347136, 8527891542343680, 8527891547586560,
  8527891552698368, 8527891559710720, 8527891568984064, 8527891578224640,
  8527891592642560, 8527891597131776, 8527891601588224, 8527891608698880,
  8527891614138368, 8527891618398208, 8527891622330368, 8527891634323456,
  8527891641958400, 8527891647102976, 8527891652444160, 8527891663552512,
  8527891684917248, 8527891690487808, 8527891694977024, 8527891704315904,
  8527891708641280, 8527891712704512, 8527891720798208, 8527891725877248,
  8527891734134784, 8527891738460160, 8527891746029568, 8527891750486016,
  8527891756482560, 8527891763724288, 8527891768705024, 8527891773882368,
  8527891786301440, 8527891797835776, 8527891803275264, 8527891807862784,
  8527891811991552, 8527891825524736, 8527891829686272, 8527891835289600,
  8527891840827392, 8527891846823936, 8527891865239552, 8527891872841728,
  8527891877855232, 8527891882213376, 8527891887226880, 8527891896303616,
  8527891901513728, 8527891908952064, 8527891914588160, 8527891920093184,
  8527891927859200, 8527891945816064, 8527891957415936, 8527891968360448,
  8527891985399808, 8527891990904832, 8527891994968064, 8527892000636928,
  8527892008599552, 8527892013580288, 8527892033273856, 8527892043431936,
  8527892046938112, 8527892054671360, 8527892060733440, 8527892065386496,
  8527892082032640, 8527892087373824, 8527892091928576, 8527892106084352,
  8527892122009600, 8527892128038912, 8527892136329216, 8527892143833088,
  8527892151402496, 8527892156481536, 8527892160577536, 8527892164968448,
  8527892169949184, 8527892187873280, 8527892192657408, 8527892197605376,
  8527892205731840, 8527892210384896, 8527892214906880, 8527892219920384,
  8527892229226496, 8527892234829824, 8527892241907712, 8527892247969792,
  8527892253048832, 8527892258553856, 8527892270612480, 8527892287160320,
  8527892292698112, 8527892300922880, 8527892310065152, 8527892315275264,
  8527892320387072, 8527892325498880, 8527892330446848,
];

function shuffleArray(arr) {
  return arr
    .map((value) => ({ value, sort: Math.random() }))
    .sort((a, b) => a.sort - b.sort)
    .map(({ value }) => value);
}

function generateAccountGroupPairs(accountIds, groupIds, ratio = 0.7) {
  const result = [];

  accountIds.forEach((accountId) => {
    const shuffled = shuffleArray(groupIds);
    const groupCount = Math.floor(groupIds.length * ratio);
    const selected = shuffled.slice(0, groupCount);

    selected.forEach((groupId) => {
      result.push({ accountId, projectId: groupId });
    });
  });

  return result;
}

function jsonToCsv(data) {
  const headers = Object.keys(data[0]);
  const rows = data.map((row) =>
    headers.map((header) => `"${row[header]}"`).join(",")
  );
  return [headers.join(","), ...rows].join("\n");
}

function saveToCsv(fileName, data) {
  const csvContent = jsonToCsv(data);
  fs.writeFileSync(fileName, csvContent, "utf8");
  console.log(`File CSV đã được tạo: ${fileName}`);
}

const pairs = generateAccountGroupPairs(accountIds, projectIds, 0.7);
const timestamp = new Date().toISOString().replace(/[-T:.Z]/g, "");
const fileName = `task_permission_${timestamp}.csv`;
saveToCsv(fileName, pairs);
